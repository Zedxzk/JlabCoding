# A python3 based script
Hello, welcome to use this scrip. This is a script developed by Zhikun Xi, an undergraduate from Wuhan University, at the end of 2024. This is a python3 based scripts. It is to run all the `.evio` (or whatever kinds, just modify the parameters in `parameters.py`) file with certain plugins and save the root file to a certain folder. And you can then use `hadd allRuns.root *root` to combine all the files for further analysis.

Suggesstions: You should make a new folder and run this command again in order to keep you woking space clean and managable. If you insist not creating a new folder, please backup all the data before getting started.

**Most Important Thing: Check the parameters in `parameters.py`**

To run the script, you should install `colorama` first(pip install colorama). Then, go to an empty folder, and type 
`/w/halld-scshelf2101/home/zhikun/codeRelease/runEvio/main.py -init `
Then check the file `parameter.py`, put all the files that you want to run in the `inputDir`, then run. After that you will see the root file in `outputDir`

For help, use `-h` option.

## Details For Each File:
### Quick View For All
Every File is in charge of a specific kind of `Action`:
|File|Action|Usage|
|:--:|:--:|:--:|
|main.py|-h|Define the basic procedure, and accept the command, the most important skeleton|
|subModule/setupEnvironment.py|-init|Initialize the environments. Specifically, to copy some pre-defined template and create some directories|
|submodule/import_parameters||Import all the parameters in `parameters.py`. If the working directory doesn't have a `parameters.py` (when the directory has not been initialized yet), use `parameters.py` template located at `/w/halld-scshelf2101/home/zhikun/codeRelease/runEvio/parameters.py`. If|
|subModule/runEvioFiles.py|-run|To run all the `.evio` files or `.hddm` files in a command and see all the results|
|subModule/hvConfig.py|-hvConfig|Used for High Voltage Configuration. Pleased Check the parameters in `parameters.py` |



### Main.py
This file is defining the action argument that we want to accept. Please look up the usage of `add_argument()`.


### setUpEnvironment.py
Here we have a function `checkInitializationStatus()` called in `main.py`. If this folder has been initialized, then check missing part. If not, initialze.

### runEvioFiles.py
Here we have a function `runAction()` called in `main.py`. But first we need to call `checkInitializationStatus()` to check initialization status. To run this action please first link or copy all the files that you want to run to `inputDir`

### hvConfig.py
Here we have a function `hvConfigureAction()` called in `main.py`. Some functions' details are as follows
|Function|Usage|Return|
|:--:|:--:|:--:|
|`hvConfigureAction()`|A plugin that can be called by `main.py`. It's used to catch any error and print the message.|No return|
|`findTemplate():`|Read the current hv configuration file. If found, nothing happens. If not, throw error and exit.|No return|
|`calculateVoltage()`|Calculate the voltage of a certain channel.|Return the correcet value of hv according to the input parameters.|
|`readResTable()`|Read the the current hv configuration file, and convert it to a dictionary to accelerate procedure. Key is generated by index(in column), and values are the information including `index,column,row,mean`|The dictionaty including the information we need for hv configuration. |